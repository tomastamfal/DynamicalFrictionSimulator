!*********************************************************************************************************
!**                                     Developed by Tomas Tamfal 					**
!**                                       Version 0.1 April 2017	                               	**
!*********************************************************************************************************

!**********************************************************************************************************
!       angularmomentum.F90:    Computes the the angular momentum in pc^2 M_sun /yr on a linear or
!                               logarithmic grid
!**********************************************************************************************************


#include "choice.def"
subroutine angularmomentum 

!**********************************************************************************************************
        use parameters, only : nr 
        use parameters, only : G, M_BH

	use variables, only : r
        use variables, only : mass
        use variables, only : L_grid




!**********************************************************************************************************
	implicit none
	integer :: i

!**********************************************************************************************************
	print *, 'Calculating angular momentum matrix'

!**************************** Computes linear r mesh *************************************
	do i = 1,nr+1
  		L_grid(i,:,:) = M_BH * DSQRT(G*mass(i,:,:)*r(i)) ! Msun * sqrt(kpc^3 / (Gyr^2 Msol) *   Msun * kpc ) = Msun * kpc^2 / Gyr 		
	enddo

!**************************** Computes log r mesh ****************************************


	open(10, file='L_data.txt', status='replace')
	do i = 1, nr+1
		write(10,*) L_grid(i,1,1)
	enddo
	close(10)


return
!**********************************************************************************************************
end subroutine angularmomentum
!**********************************************************************************************************
